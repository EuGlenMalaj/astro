---
import BaseLayout from '../../layouts/BaseLayout.astro';
export const getStaticPaths = async () => {
  let allData = await fetch(
    `https://glenmalaj.cdn.prismic.io/api/v2?access_token=${
      import.meta.env.PRISMIC_ACCESS_TOKEN
    }`
  )
    .then((res) => res.json())
    .catch((e) => console.log(e));

  const masterRef = allData.refs.filter(({ id }) => id === 'master')[0].ref;
  let projects = await fetch(
    `https://glenmalaj.cdn.prismic.io/api/v2/documents/search?ref=${masterRef}&access_token=${
      import.meta.env.PRISMIC_ACCESS_TOKEN
    }`
  )
    .then((res) => res.json())
    .catch((e) => console.log(e));
  projects = projects.results;
  return projects.map((project) => {
    return {
      params: {
        slug: project.slugs[0],
      },
      props: { project },
    };
  });
};

const { project } = Astro.props;
console.log(project.data);
---

<BaseLayout title={`Euglen Malaj | ${project.data.title[0].text}`}>
  <div>{project.data.title[0].text}</div>
</BaseLayout>
